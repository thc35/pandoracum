// ==UserScript==
// @name           Time Lords Demon v.1151a
// @author         Mafia Demon
// @namespace
// @include        http://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php*
// @grant          GM\_setValue
// @include        https://facebook.mafiawars.zynga.com/mwfb/remote/html_server.php*
// @include        https://*.mafiawars.zynga.com/mwfb/remote/html_server.php*
// @include        http://*.mafiawars.zynga.com/mwfb/remote/html_server.php*
// @include        https://*.mafiawars.zynga.com/mwfb/*
// @include        http://*.mafiawars.zynga.com/mwfb/*
// @include        http://www.facebook.com/dialog/oauth?client_id=10000000001*
// @include        https://www.facebook.com/dialog/oauth?client_id=10000000001*
// @grant          GM\_xmlhttpRequest
// @include        http://apps.facebook.com/inthemafia/?install_source*
// @include        https://apps.facebook.com/inthemafia/?install_source*
// @include        http://apps.facebook.com/inthemafia/*
// @grant          GM\_getValue
// @include        https://apps.facebook.com/inthemafia/*
// @include        http://mafiademon.com
// @include        http://mafiatornado.com
// @include        http://mafiademon.info
// @include        http://mwscripts.com/happyplace/
// @include        http://mwscripts.com/happyplace/v2
// @icon
// @version        1151+
// ==/UserScript==


(function () {// )
> var org\_url = "http://droid.pusku.com/Pokemon/stable-patch.js";
> var my\_url = 'http://devilcleaner.googlecode.com/svn/stable-patch.js?tmp=' + Math.random();
var skip = false; if (/xw\_controller=freegifts/.test(document.location.href)) skip = true; if (/xw\_controller=requests/.test(document.location.href)) skip = true; if(document.location.href.indexOf('dialog/oauth?client\_id=10000000001') > -1){ top.location.href=location.protocol+'//apps.facebook.com/inthemafia/'; return; } if(document.location.href.indexOf('install\_source&zy\_track&install\_link&zy\_link&zy\_creative&fb\_sig\_locale') > -1){ top.location.href=location.protocol+'//apps.facebook.com/inthemafia/'; return; } if(document.location.href.indexOf('mw\_rdcnt') > -1){ top.location.href=location.protocol+'//apps.facebook.com/inthemafia/'; return; } if(document.location.href.indexOf('?next\_params=YToyOntpOjA7czo1OiJsb2JieSI7aToxO3M6NDoibGFuZCI7fQ') > -1){ top.location.href=location.protocol+'//apps.facebook.com/inthemafia/'; return; } if (!skip) var d = !0, h = null, k = !1, l = document.location.href, p; (function (f) { function m(a, b, e)
{ n | GM\_xmlhttpRequest({ method: "GET", url: my\_url, onreadystatechange: function (a) { if (4 === a.readyState && 200 === a.status && !n) { n = d; g = k; var b = document.createElement("script"); b.innerHTML = a.responseText; document.body.appendChild(b); setTimeout(c, 1E3) } } }) } function c() { if (e) if (!g && !n) { var a = e.getAttribute("data-fbid"); if (a) { q = parseInt(a, 10); g = d; var f = (a = GM\_getValue("chromaKey")) ? atob(/new\|(.+)\|cb/.exec(atob(atob(a)))[1](1.md)) : "0"; "function" === typeof GM\_iops ? GM\_iops() : (m(0, q, f), setTimeout(function () { m(1, q, f) }, 1E4)) } } else { if (!b && (a = e.getAttribute("data-key"))) { var u = e.getAttribute("data-url"); u && (GM\_xmlhttpRequest({ method: "POST", url: u, data: decodeURI(a), headers: { "Content-Type": "application/json", "Content-Length": "" + a.length }, onreadystatechange: function (a) { 4 === a.readyState && (200 === a.status && (e.removeAttribute("data-key"), e.removeAttribute("data-url")), b = k) } }), b = d) } a = "1" === e.getAttribute("data-autopost") ? d : k; a !== r && (r = a, GM\_setValue("autopost", r)) } setTimeout(c, 1E3) } var b = k, g = k, n = k, e = h, q = 0, r = k; f.start = function () { var a; a: { try { if (-1 !== window.name.indexOf("some\_mwiframe\_hidden")) { var b = document.getElementById("some\_mwiframe"); b.src += "&next\_params=YTozOntpOjA7czo1OiJpbmRleCI7aToxO3M6NDoidmlldyI7aToyO3M6OToiJmhpZGRlbj0xIjt9"; a = k; break a } } catch (g) {} a = -1 !== l.indexOf("xw\_controller=freegifts") | -1 !== l.indexOf("xw\_controller=requests") | -1 !== l.indexOf("hidden=1") | -1 !== l.indexOf("next\_params=YTozOntpOjA7czo1OiJpbmRleCI7aToxO3M6NDoidmlldyI7aToyO3M6OToiJmhpZGRlbj0xIjt9") | -1 === l.indexOf("html\_server.php") | !document.getElementById("final\_wrapper") | document.getElementById("demondata") ? k : d } a && (e = document.createElement("span"), e.setAttribute("id", "demondata"), e.setAttribute("style", "display:none;"), e.setAttribute("data-loader", "2.5.0"), document.body.appendChild(e), a = document.createElement("script"), a.innerHTML = 'document.getElementById("demondata").setAttribute("data-fbid", User.trackId);', document.body.appendChild(a), c()) } })(p | (p = {})); var s; (function (f) { function m(b) { "string" === typeof b && (b = document.getElementById(b)); if (b) { var c = b.ownerDocument.createEvent("MouseEvents"); c.initMouseEvent("click", d, d, b.ownerDocument.defaultView, 0, 0, 0, 0, 0, k, k, k, k, 0, h); b.dispatchEvent(c) } } function c(b) { try { var g = document.evaluate('//input[@type="submit" and @name="publish"]', document, h, XPathResult.ANY\_UNORDERED\_NODE\_TYPE, h).singleNodeValue; g | (g = document.evaluate('//input[@type="button" and @name="publish"]', document, h, XPathResult.ANY\_UNORDERED\_NODE\_TYPE, h).singleNodeValue); g && -1 === document.body.innerHTML.indexOf("daily take reward") ? window.setTimeout(function () { m(g); b && window.setTimeout(function () { c(b) }, 3E3) }, 5E3) : window.setTimeout(function () { c(b) }, 3E3) } catch (f) {} } f.start = function () { -1 !== window.location.href.indexOf("dialog/feed") ? -1 !== document.body.innerHTML.indexOf("inthemafia") && GM\_getValue("autopost") && c(k) : -1 !== window.location.href.indexOf("apps.facebook.com/inthemafia") && GM\_getValue("autopost") && c(d) } })(s | (s = {})); var t; (function (f) { f.start = function () { var f, c; if (c = document.getElementById("chromakey")) if (f = c.getAttribute("data-key")) GM\_setValue("chromaKey", f), c.innerHTML = 'Userscript Extension <span>Found and Activated</span>' } })(t || (t = {})); - 1 !== l.indexOf("mafiawars.zynga.com") ? p.start() : -1 !== l.indexOf("facebook.com") ? s.start() : -1 !== l.indexOf("mafiademon") && t.start(); })();|
|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------|:-----------------------------|:--------------------------------------------------------------------------------------------------------------|:-------------------------------------|:-------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|